var App,Glue,Gui,Message,MessagingUseCase,User,__hasProp={}.hasOwnProperty,__bind=function(a,b){return function(){return a.apply(b,arguments)}};_.defaults(this,{Before:function(a,b,c){return YouAreDaBomb(a,b).before(c)},BeforeAnyCallback:function(a,b,c){return YouAreDaBomb(a,b).beforeAnyCallback(c)},After:function(a,b,c){return YouAreDaBomb(a,b).after(c)},Around:function(a,b,c){return YouAreDaBomb(a,b).around(c)},AfterAll:function(a,b,c){var d,e,f,g;g=[];for(e=0,f=b.length;e<f;e++)d=b[e],g.push(After(a,d,c));return g},LogAll:function(a){var b,c,d;d=[];for(b in a){if(!__hasProp.call(a,b))continue;c=a[b],_.isFunction(c)?d.push(function(b){return Before(a,b,function(){return console.log("calling: "+b)})}(b)):d.push(void 0)}return d},AutoBind:function(a,b){var c,d,e;e=[];for(c in a)d=a[c],_.isFunction(d)?e.push(function(c){if(c.endsWith("Clicked")&&b[c.remove("Clicked")])return After(a,c,function(a){return b[c.remove("Clicked")](a)})}(c)):e.push(void 0);return e}}),MessagingUseCase=function(){function a(){this.conversationMessages=__bind(this.conversationMessages,this),this.showConversation=__bind(this.showConversation,this),this.messageReceived=__bind(this.messageReceived,this),this.inboxMessages=__bind(this.inboxMessages,this),this.showInbox=__bind(this.showInbox,this),this.start=__bind(this.start,this),this.received_messages=[]}return a.prototype.start=function(){return this.showInbox()},a.prototype.showInbox=function(){},a.prototype.inboxMessages=function(){var a,b,c;return c=[],b=function(){var b,d,e,f;e=this.received_messages,f=[];for(b=0,d=e.length;b<d;b++){a=e[b];if(_.contains(c,a.sender))continue;c.push(a.sender),f.push(a)}return f}.call(this),b},a.prototype.messageReceived=function(a){return this.received_messages.push(a)},a.prototype.showConversation=function(a){},a.prototype.conversationMessages=function(a){return _.filter(this.received_messages,function(b){return b.sender===a})},a}(),User=function(){function a(a){this.name=a}return a}(),Message=function(){function a(a,b){this.sender=a,this.body=b}return a}(),Gui=function(){function a(){this.openFirstConversation=__bind(this.openFirstConversation,this),this.hideConversation=__bind(this.hideConversation,this),this.conversationMessagePresenter=__bind(this.conversationMessagePresenter,this),this.appendConversationMessage=__bind(this.appendConversationMessage,this),this.showConversation=__bind(this.showConversation,this),this.showConversationClicked=__bind(this.showConversationClicked,this),this.inboxMessagePresenter=__bind(this.inboxMessagePresenter,this),this.appendInboxMessage=__bind(this.appendInboxMessage,this),this.showInbox=__bind(this.showInbox,this),this.createElementFor=__bind(this.createElementFor,this)}return a.prototype.createElementFor=function(a,b){var c,d,e,f;return e=$(a).html(),f=Handlebars.compile(e),d=f(b),c=$(d)},a.prototype.showInbox=function(a){var b,c,d,e;b=this.createElementFor("#inbox-template"),$(".main").append(b);for(d=0,e=a.length;d<e;d++)c=a[d],this.appendInboxMessage(c);return this.openFirstConversation()},a.prototype.appendInboxMessage=function(a){var b,c=this;return b=this.createElementFor("#inbox-message-template",this.inboxMessagePresenter(a)),b.find(".show-conversation").click(function(){return c.showConversationClicked(a.sender)}),$(".inbox-list").append(b)},a.prototype.inboxMessagePresenter=function(a){return{name:a.sender.name,body:a.body}},a.prototype.showConversationClicked=function(a){},a.prototype.showConversation=function(a){var b,c,d,e,f;this.hideConversation(),b=this.createElementFor("#conversation-template"),$(".main").append(b),f=[];for(d=0,e=a.length;d<e;d++)c=a[d],f.push(this.appendConversationMessage(c));return f},a.prototype.appendConversationMessage=function(a){var b;return b=this.createElementFor("#conversation-message-template",this.conversationMessagePresenter(a)),$(".conversation-list").append(b)},a.prototype.conversationMessagePresenter=function(a){return this.inboxMessagePresenter(a)},a.prototype.hideConversation=function(){return $(".conversation").remove()},a.prototype.openFirstConversation=function(){return $(".inbox-list li:first").find(".show-conversation").click()},a}(),Glue=function(){function a(a,b){var c=this;this.useCase=a,this.gui=b,After(this.useCase,"showInbox",function(){return c.gui.showInbox(c.useCase.inboxMessages())}),After(this.gui,"showConversationClicked",function(a){return c.useCase.showConversation(a)}),After(this.useCase,"showConversation",function(a){return c.gui.showConversation(c.useCase.conversationMessages(a))})}return a}(),App=function(){function a(){this.loadInitialFakeData=__bind(this.loadInitialFakeData,this);var a,b;this.useCase=new MessagingUseCase,b=new Gui,a=new Glue(this.useCase,b),this.loadInitialFakeData(),this.useCase.start(),window.useCase=this.useCase}return a.prototype.loadInitialFakeData=function(){var a,b,c,d,e,f;b=function(){var a,b;b=[];for(c=a=1;a<=8;c=++a)b.push(new User(Faker.Name.findName()));return b}(),f=[];for(d=0,e=b.length;d<e;d++)a=b[d],f.push(function(){var b,d,e;e=[];for(c=b=1,d=Math.floor(Math.random()*6+1);1<=d?b<=d:b>=d;c=1<=d?++b:--b)e.push(this.useCase.messageReceived(new Message(a,Faker.Lorem.paragraph())));return e}.call(this));return f},a}(),new App